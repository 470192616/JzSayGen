
            System.ComponentModel.BackgroundWorker m_BackgroundWorker = new System.ComponentModel.BackgroundWorker();
            m_BackgroundWorker.WorkerReportsProgress = true; // 设置可以通告进度
            m_BackgroundWorker.WorkerSupportsCancellation = true; // 设置可以取消
            m_BackgroundWorker.DoWork += new System.ComponentModel.DoWorkEventHandler(m_BackgroundWorker_DoWork);
            m_BackgroundWorker.ProgressChanged += new System.ComponentModel.ProgressChangedEventHandler(m_BackgroundWorker_ProgressChanged);
            m_BackgroundWorker.RunWorkerCompleted += new System.ComponentModel.RunWorkerCompletedEventHandler(m_BackgroundWorker_RunWorkerCompleted);
            m_BackgroundWorker.RunWorkerAsync(DateTime.Now.ToString());
            



void m_BackgroundWorker_RunWorkerCompleted(object sender, System.ComponentModel.RunWorkerCompletedEventArgs e)
        {
            if (e.Error != null) {

            }
            else if (e.Cancelled)
            {

            }
            else
            {
                //e.Result
            }
        }

        void m_BackgroundWorker_ProgressChanged(object sender, System.ComponentModel.ProgressChangedEventArgs e)
        {
            int progress = e.ProgressPercentage;
   
        }

        void m_BackgroundWorker_DoWork(object sender, System.ComponentModel.DoWorkEventArgs e)
        {
            System.ComponentModel.BackgroundWorker bw = (System.ComponentModel.BackgroundWorker)sender;
            string timeStr = e.Argument.ToString();

            if (bw.CancellationPending)
            {
                e.Cancel = true;                
            }

            bw.ReportProgress(10);
            e.Result = "ko";
        }